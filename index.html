<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ã‚¿ãƒƒãƒ—RPG å®Œå…¨çµ±åˆç‰ˆ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{background:#111;color:#fff;font-family:sans-serif;text-align:center;margin:0;padding:20px}
button,input{font-size:14px;padding:8px 14px;margin:4px}
#tapBtn{font-size:26px;padding:28px 56px;margin-top:20px}
.hidden{display:none!important}
.boss{font-size:72px}
.player{font-size:60px}
.hp-bar{width:80%;height:20px;background:#444;margin:10px auto;border-radius:10px;overflow:hidden}
.hp{height:100%;background:red}
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.9);display:flex;justify-content:center;align-items:center;z-index:999;font-size:20px;text-align:center;padding:20px}
</style>
</head>
<body>

<h1>ğŸ”¥ ã‚¿ãƒƒãƒ—RPG ğŸ”¥</h1>

<p>
ğŸ’° <span id="coin">0</span>
ã€€ğŸ’ <span id="dia">0</span>
ã€€âš” +<span id="atk">0</span>
</p>

<div class="player" id="player">ğŸ™‚</div>

<!-- ã‚¬ãƒãƒ£ -->
<button onclick="drawGacha()">ğŸ° ã‚¬ãƒãƒ£</button>
<button onclick="draw10()">ğŸ° 10é€£</button>
<button onclick="drawDiaGacha()">ğŸ’ ä¸Šä½</button>
<button onclick="drawDia10()">ğŸ’ ä¸Šä½10é€£</button>
<button onclick="drawNew()">ğŸŒˆ æ–°ã‚¬ãƒãƒ£</button>
<button onclick="drawNew10()">ğŸŒˆ æ–°ã‚¬ãƒãƒ£10é€£</button>
<button onclick="showDex()">ğŸ“– å›³é‘‘</button>

<hr>

<input id="diaNum" type="number" min="1" placeholder="å¤‰æ›æ•°">
<button onclick="exchangeDia()">ğŸ’°â†’ğŸ’å¤‰æ›</button>

<hr>

<button onclick="toggleAuto()">ğŸ¤– ã‚ªãƒ¼ãƒˆã‚¿ãƒƒãƒ—</button>
<button onclick="startRush()">ğŸ”¥ ãƒœã‚¹ãƒ©ãƒƒã‚·ãƒ¥</button>

<hr>

<div id="select">
<h2>ãƒœã‚¹é¸æŠ</h2>

<!-- é€šå¸¸ -->
<button onclick="startBattle('ã‚¹ãƒ©ã‚¤ãƒ ',100,'ğŸŸ¢',10)">ã‚¹ãƒ©ã‚¤ãƒ </button>
<button onclick="startBattle('ã‚´ãƒ–ãƒªãƒ³',200,'ğŸ‘º',20)">ã‚´ãƒ–ãƒªãƒ³</button>
<button onclick="startBattle('ã‚ªãƒ¼ã‚¯',500,'ğŸ‘¹',50)">ã‚ªãƒ¼ã‚¯</button>
<button onclick="startBattle('ãƒ‰ãƒ©ã‚´ãƒ³',2000,'ğŸ‰',200)">ãƒ‰ãƒ©ã‚´ãƒ³</button>
<button onclick="startBattle('ç¥ç«œ',8000,'ğŸ²âœ¨',800)">ç¥ç«œ</button>

<!-- ãƒ€ã‚¤ãƒ¤ã‚­ãƒ£ãƒ© -->
<button onclick="startBattle('é’æ™¶ã‚¹ãƒ©ã‚¤ãƒ (ãƒ€ã‚¤ãƒ¤ã‚­ãƒ£ãƒ©)',1500,'ğŸ’',2,true)">é’æ™¶ã‚¹ãƒ©ã‚¤ãƒ </button>
<button onclick="startBattle('çµæ™¶ã‚´ãƒ–ãƒªãƒ³(ãƒ€ã‚¤ãƒ¤ã‚­ãƒ£ãƒ©)',4000,'ğŸ’',3,true)">çµæ™¶ã‚´ãƒ–ãƒªãƒ³</button>
<button onclick="startBattle('å®çŸ³ã‚ªãƒ¼ã‚¯(ãƒ€ã‚¤ãƒ¤ã‚­ãƒ£ãƒ©)',12000,'ğŸ’',5,true)">å®çŸ³ã‚ªãƒ¼ã‚¯</button>
<button onclick="startBattle('è¼ç«œ(ãƒ€ã‚¤ãƒ¤ã‚­ãƒ£ãƒ©)',40000,'ğŸ’',10,true)">è¼ç«œ</button>

<hr>
<h3>ğŸ’€ è¶…é«˜HPãƒœã‚¹</h3>

<button onclick="startBattle('è™šç„¡ã®ã‚¹ãƒ©ã‚¤ãƒ ',500000,'âš«',5000)">è™šç„¡ã®ã‚¹ãƒ©ã‚¤ãƒ </button>
<button onclick="startBattle('ç ´å£Šã‚´ãƒ–ãƒªãƒ³',1200000,'ğŸ’¥',12000)">ç ´å£Šã‚´ãƒ–ãƒªãƒ³</button>
<button onclick="startBattle('ç‹‚æˆ¦å£«ã‚ªãƒ¼ã‚¯',3000000,'ğŸ”¥',35000)">ç‹‚æˆ¦å£«ã‚ªãƒ¼ã‚¯</button>
<button onclick="startBattle('ç½å„ãƒ‰ãƒ©ã‚´ãƒ³',8000000,'ğŸ‰ğŸ”¥',120000)">ç½å„ãƒ‰ãƒ©ã‚´ãƒ³</button>
<button onclick="startBattle('å •å¤©ç¥ç«œ',20000000,'ğŸ˜ˆğŸ²',300000)">å •å¤©ç¥ç«œ</button>

<button onclick="startBattle('è™šç„¡ã®ã‚´ãƒ–ãƒªãƒ³',35000000,'âš«',400000)">è™šç„¡ã®ã‚´ãƒ–ãƒªãƒ³</button>
<button onclick="startBattle('ç ´æ»…ã‚ªãƒ¼ã‚¯',50000000,'ğŸ’¥',600000)">ç ´æ»…ã‚ªãƒ¼ã‚¯</button>
<button onclick="startBattle('çµ‚ç„‰ãƒ‰ãƒ©ã‚´ãƒ³',70000000,'ğŸ‰',900000)">çµ‚ç„‰ãƒ‰ãƒ©ã‚´ãƒ³</button>
<button onclick="startBattle('å •è½ç¥ç«œ',100000000,'ğŸ²',1300000)">å •è½ç¥ç«œ</button>
<button onclick="startBattle('æ·±æ·µã®ã‚¹ãƒ©ã‚¤ãƒ ',140000000,'âš«',1800000)">æ·±æ·µã®ã‚¹ãƒ©ã‚¤ãƒ </button>

<button onclick="startBattle('å¥ˆè½ã‚´ãƒ–ãƒªãƒ³',200000000,'ğŸ‘¿',2500000)">å¥ˆè½ã‚´ãƒ–ãƒªãƒ³</button>
<button onclick="startBattle('å†¥ç•Œã‚ªãƒ¼ã‚¯',280000000,'ğŸ‘¿',3500000)">å†¥ç•Œã‚ªãƒ¼ã‚¯</button>
<button onclick="startBattle('ç ´å£Šç¥ãƒ‰ãƒ©ã‚´ãƒ³',400000000,'ğŸ‰ğŸ”¥',5000000)">ç ´å£Šç¥ãƒ‰ãƒ©ã‚´ãƒ³</button>
<button onclick="startBattle('ç¥æ®ºã—ã®ç«œ',600000000,'ğŸ²âœ¨',8000000)">ç¥æ®ºã—ã®ç«œ</button>
<button onclick="startBattle('è™šç©ºã®ç¥ç«œ',900000000,'â˜ ï¸',12000000)">è™šç©ºã®ç¥ç«œ</button>

<button onclick="startBattle('çµ‚æœ«ã®ã‚¹ãƒ©ã‚¤ãƒ ',1300000000,'â˜ ï¸',18000000)">çµ‚æœ«ã®ã‚¹ãƒ©ã‚¤ãƒ </button>
<button onclick="startBattle('çµ¶æœ›ã‚´ãƒ–ãƒªãƒ³',1800000000,'â˜ ï¸',25000000)">çµ¶æœ›ã‚´ãƒ–ãƒªãƒ³</button>
<button onclick="startBattle('æ»…ç•Œã‚ªãƒ¼ã‚¯',2500000000,'â˜ ï¸',35000000)">æ»…ç•Œã‚ªãƒ¼ã‚¯</button>
<button onclick="startBattle('ç½ç¦ç¥ç«œ',3500000000,'â˜ ï¸',50000000)">ç½ç¦ç¥ç«œ</button>
<button onclick="startBattle('ä¸–ç•Œã‚’å–°ã‚‰ã†ç«œ',5000000000,'â˜ ï¸',80000000)">ä¸–ç•Œã‚’å–°ã‚‰ã†ç«œ</button>

</div>

<div id="game" class="hidden">
<h2 id="bossName"></h2>
<div class="boss" id="bossIcon"></div>
<div class="hp-bar"><div class="hp" id="hp"></div></div>
<p>HP: <span id="hpText"></span></p>
<button id="tapBtn" onclick="tap()">ã‚¿ãƒƒãƒ—ï¼</button>
</div>

<div id="overlay" class="overlay hidden"></div>

<script>
const coinEl=document.getElementById("coin");
const diaEl=document.getElementById("dia");
const atkEl=document.getElementById("atk");
const overlay=document.getElementById("overlay");

let coin=+localStorage.getItem("coin")||0;
let dia=+localStorage.getItem("dia")||0;
let atkBonus=+localStorage.getItem("atkBonus")||0;
let dex=JSON.parse(localStorage.getItem("dex")||"{}");

function save(){
coinEl.textContent=coin;
diaEl.textContent=dia;
atkEl.textContent=atkBonus;
localStorage.setItem("coin",coin);
localStorage.setItem("dia",dia);
localStorage.setItem("atkBonus",atkBonus);
localStorage.setItem("dex",JSON.stringify(dex));
}
save();

/* --- ã‚¬ãƒãƒ£ --- */
const normal=[["R",50,0.1],["SR",30,0.3],["UR",15,1],["LR",5,2]];
const diaG=[["UR",50,1.5],["LR",35,3],["DIVINE",15,10]];
const newG=[
["ãƒ‡ã‚£ãƒã‚¤ãƒ³",50,10],
["ãƒ‡ã‚£ãƒã‚¤ãƒ³â…¡",33,100],
["ãƒ‡ã‚£ãƒã‚¤ãƒ³â…¢",17,1000]
];

function roll(t){
let r=Math.random()*100,s=0;
for(const g of t){s+=g[1];if(r<s)return g;}
}

function drawNew(){
if(dia<100)return;
dia-=100;
const g=roll(newG);
atkBonus+=g[2];
dex[g[0]]=(dex[g[0]]||0)+1;
save();
overlay.innerHTML=`ğŸŒˆ æ–°ã‚¬ãƒãƒ£çµæœ<br>${g[0]}<br>âš” +${g[2]}<br><small>(ã‚¿ãƒƒãƒ—ã§é–‰ã˜ã‚‹)</small>`;
overlay.classList.remove("hidden");
}

function drawNew10(){
if(dia<1000)return;
dia-=1000;
let txt="ğŸŒˆ æ–°ã‚¬ãƒãƒ£10é€£<br>";
for(let i=0;i<10;i++){
const g=roll(newG);
atkBonus+=g[2];
dex[g[0]]=(dex[g[0]]||0)+1;
txt+=`${g[0]} (+${g[2]})<br>`;
}
save();
overlay.innerHTML=txt+"<small>(ã‚¿ãƒƒãƒ—ã§é–‰ã˜ã‚‹)</small>";
overlay.classList.remove("hidden");
}

overlay.onclick=()=>overlay.classList.add("hidden");

/* --- æˆ¦é—˜ --- */
let bossHp=0,maxHp=0,reward=0,isDia=false;

function startBattle(n,h,i,r,d=false){
bossName.textContent=n;
bossIcon.textContent=i;
bossHp=maxHp=h;
reward=r;
isDia=d;
select.classList.add("hidden");
game.classList.remove("hidden");
updateHp();
}

function tap(){
bossHp-=1+atkBonus;
if(bossHp<=0){
if(isDia)dia+=reward;
else coin+=reward;
save();
game.classList.add("hidden");
select.classList.remove("hidden");
overlay.innerHTML=`ğŸ‰ æ’ƒç ´ï¼<br>${isDia?"ğŸ’ +":"ğŸ’° +"}${reward}<br><small>(ã‚¿ãƒƒãƒ—ã§é–‰ã˜ã‚‹)</small>`;
overlay.classList.remove("hidden");
}
updateHp();
}

function updateHp(){
hpText.textContent=Math.max(0,Math.ceil(bossHp));
hp.style.width=(bossHp/maxHp*100)+"%";
}
</script>
</body>
</html>
